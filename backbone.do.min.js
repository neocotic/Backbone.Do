/*! Backbone.Do v0.1.3 | (c) 2013 Alasdair Mercer | MIT License */
!function(a,b){"use strict";"object"==typeof exports?module.exports=b(require("underscore"),require("Backbone"),a):"function"==typeof define&&define.amd?define(["underscore","backbone"],function(c,d){return b(c,d,a)}):b(a._,a.Backbone,a)}(this,function(a,b,c){"use strict";function d(a,b){var c=b.error;b.error=function(d){c&&c(a,d,b),a.trigger("error",a,d,b)}}function e(b){var c=a.result(b,"attrs");return a.isString(c)&&(c=c.split(/\s+/)),c||[]}a=void 0===a?c._:a,b=void 0===b?c.Backbone:b;var f=b.Do=function(b){var c=a.result(b,"actions");return a.each(c,function(d,e){d=a.result(c,e),b[e]=function(a){return f.perform(b,d,e,a)}}),f};f.defaultMethod="POST",f.VERSION="0.1.3";var g=/^(DELETE|PATCH|PUT)$/,h={POST:"create",PUT:"update",PATCH:"patch",DELETE:"delete",GET:"read"};f.getOptions=function(c,d,i,j){j=a.extend({contentType:"application/json",emulateHTTP:b.emulateHTTP,emulateJSON:b.emulateJSON,validate:!0},d,j);var k=a.result(j,"method");k&&(k=k.toUpperCase()),h[k]||(k=f.defaultMethod),j.method=h[k];var l=a.result(c,"url"),m=a.result(j,"url")||f.parseName(i),n="/"===l[l.length-1]?"":"/";j.url=l+n+encodeURIComponent(m);var o=a.extend({},a.result(d,"data"),a.result(j,"data"));return a.isEmpty(o)&&(o=c.pick(a.union(e(d),e(j)))),j.data=a.isEmpty(o)?null:o,j.data&&"GET"!==k&&(j.data=JSON.stringify(j.data)),j.emulateJSON&&(j.contentType="application/x-www-form-urlencoded",j.data=j.data?{data:j.data}:{}),j.emulateHTTP&&j.emulateJSON&&g.test(k)&&(j.data._method=k),j},f.parseName=function(a){return a},f.perform=function(b,c,e,g){g=f.getOptions(b,c,e,g);var h=g.method,i=b.attributes;g=a.omit(g,"attrs","method"),a.isUndefined(g.parse)&&(g.parse=!0);var j=g.success;return g.success=function(c){b.attributes=i;var d=b.parse(c,g);return a.isObject(d)&&!b.set(d,g)?!1:(j&&j(b,c,g),b.trigger("action:"+e,b,c,g),b.trigger("action",b,e,c,g),void 0)},d(b,g),b.sync(h,b,g)}});
/*
//@ sourceMappingURL=backbone.do.min.map
*/
/*! Backbone.Do v1.0.0 | (c) 2017 Alasdair Mercer | MIT License */
!function(e,t){"use strict";"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("underscore"),require("backbone"),e):"function"==typeof define&&define.amd?define(["underscore","backbone"],function(r,n){return t(r,n,e)}):t(e._,e.Backbone,e)}(this,function(e,t,r){"use strict";e=void 0===e?r._:e;var n=(t=void 0===t?r.Backbone:t).Do=function(t){var r=e.result(t,"actions");return e.each(r,function(r,i){if(!e.isUndefined(t[i]))throw new Error("Property already exists with action name: "+i);t[i]=e.partial(n.perform,t,i)}),n};n.defaultMethod="update",n.VERSION="1.0.0";var i=function(e,t){var r=t.error;t.error=function(n){r&&r(e,n,t),e.trigger("error",e,n,t)}},a=function(t){var r=e.result(t,"attrs");return e.isString(r)&&(r=r.split(/\s+/)),r||[]};n.getOptions=function(r,i,o,s,u){u=e.extend({validate:!0},i,u),e.isUndefined(u.parse)&&(u.parse=!0),u.method=e.result(u,"method")||n.defaultMethod;var c=e.result(r,"url"),d=e.result(u,"url")||n.parseName(o),f="/"===c[c.length-1]?"":"/";u.url=c+f+d,s=e.isFunction(s)?s.call(r):s,s=e.extend({},e.result(i,"data"),s);var l=e.union(a(i),a(u));return e.isEmpty(s)&&(s=r instanceof t.Model?r.pick(l):r.map(function(e){return e.pick(l)})),u.data=e.isEmpty(s)?null:s,u},n.parseName=function(e){return e},n.perform=function(r,a,o,s){var u=r.actions[a];u=e.isFunction(u)?u.call(r):u;var c=(s=n.getOptions(r,u,a,o,s)).method,d=r.attributes;null==(s=e.omit(s,"attrs","method")).data||"create"!==c&&"update"!==c&&"patch"!==c||(s.attrs=s.data,delete s.data);var f=s.success;return s.success=function(n){var i,o;if(r instanceof t.Model){if(r.attributes=d,o=r.parse(n,s),e.isObject(o)&&!r.set(o,s))return!1}else i=s.reset?"reset":"set",r[i](n,s);f&&f(r,n,s),r.trigger("action:"+a,r,n,s),r.trigger("action",r,a,n,s)},i(r,s),r.sync(c,r,s)}});
//# sourceMappingURL=backbone.do.min.map
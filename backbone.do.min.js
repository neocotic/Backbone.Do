/*! Backbone.Do v1.0.0 | (c) 2014 Alasdair Mercer | MIT License
*/
!function(a,b){"use strict";"object"==typeof exports?module.exports=b(require("underscore"),require("backbone"),a):"function"==typeof define&&define.amd?define(["underscore","backbone"],function(c,d){return b(c,d,a)}):b(a._,a.Backbone,a)}(this,function(a,b,c){"use strict";a=void 0===a?c._:a,b=void 0===b?c.Backbone:b;var d=b.Do=function(b){var c=a.result(b,"actions");return a.each(c,function(c,e){if(!a.isUndefined(b[e]))throw new Error("Property already exists with action name: "+e);b[e]=a.partial(d.perform,b,e)}),d};d.defaultMethod="update",d.VERSION="1.0.0";var e=function(a,b){var c=b.error;b.error=function(d){c&&c(a,d,b),a.trigger("error",a,d,b)}},f=function(b){var c=a.result(b,"attrs");return a.isString(c)&&(c=c.split(/\s+/)),c||[]};d.getOptions=function(c,e,g,h,i){i=a.extend({validate:!0},e,i),a.isUndefined(i.parse)&&(i.parse=!0),i.method=a.result(i,"method")||d.defaultMethod;var j=a.result(c,"url"),k=a.result(i,"url")||d.parseName(g),l="/"===j[j.length-1]?"":"/";i.url=j+l+k,h=a.isFunction(h)?h.call(c):h,h=a.extend({},a.result(e,"data"),h);var m=a.union(f(e),f(i));return a.isEmpty(h)&&(h=c instanceof b.Model?c.pick(m):c.map(function(a){return a.pick(m)})),i.data=a.isEmpty(h)?null:h,i},d.parseName=function(a){return a},d.perform=function(c,f,g,h){var i=c.actions[f];i=a.isFunction(i)?i.call(c):i,h=d.getOptions(c,i,f,g,h);var j=h.method,k=c.attributes;h=a.omit(h,"attrs","method"),null==h.data||"create"!==j&&"update"!==j&&"patch"!==j||(h.attrs=h.data,delete h.data);var l=h.success;return h.success=function(d){var e,g;if(c instanceof b.Model){if(c.attributes=k,g=c.parse(d,h),a.isObject(g)&&!c.set(g,h))return!1}else e=h.reset?"reset":"set",c[e](d,h);l&&l(c,d,h),c.trigger("action:"+f,c,d,h),c.trigger("action",c,f,d,h)},e(c,h),c.sync(j,c,h)}});
//# sourceMappingURL=backbone.do.min.map